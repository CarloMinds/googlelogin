@{
    Layout = "_Layout";
    ViewBag.title = "Company";
}

@try
{
    <div class="flex-grow-1 container-p-y container-fluid">
        <div class="card">
            <div class="row">
                <h5 class="card-header ms-5 col">Companies</h5>
                <div class="text-end mt-5 me-10 col">
                    <button class="btn btn-secondary create-new btn-primary waves-effect waves-light" type="button" onclick="OnOpenModal();">
                        <span>
                            <i class="ti ti-plus me-sm-1"></i>
                            <span class="d-none d-sm-inline-block">Add</span>
                        </span>
                    </button>
                    <div class="modal fade" id="modalCenter" tabindex="-1" style="display: none;" aria-modal="true" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="modalCenterTitle">Add member</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="handleOpenModal();"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="mb-4">
                                        <label class="form-label">Email address</label>
                                        <input type="email" class="form-control" id="input_email_name" placeholder="name@example.com">
                                    </div>
                                    <div class="mb-4">
                                        <label class="form-label">Client Id</label>
                                        <textarea class="form-control" id="input_client_id" rows="3"></textarea>
                                    </div>
                                    <div class="mb-4">
                                        <label class="form-label">Client Secret</label>
                                        <input id="input_client_secret" class="form-control" type="text" placeholder="Client Secret">
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-label-secondary waves-effect" data-bs-dismiss="modal" onclick="handleOpenModal();">
                                        Close
                                    </button>
                                    <button type="button" class="btn btn-primary waves-effect waves-light" onclick="handleSaveClick();">Save changes</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-body" id="user_list">
            </div>
        </div>
    </div>

    
}
catch (Exception ex)
{
    Console.WriteLine("dashbaord" + ex.Message);
}

<script type="text/javascript">
    $(document).ready(function () {
        loadMembers();
    });

    function loadMembers() {
        $.post('/getMembers', {}, function (data) {
            try {
                $('#mail_list').html(data);
            } catch (e) {
                console.log(e);
            } finally {
            }
        }, 'html');
    }

    function OnEditMember(userIdx) {
        $.post('/editMember', { userIdx: userIdx }, (res) => {
            console.log(res.status);
            if ( res.status == 201  ) {
                loadMembers();
            } else {
                console.log("Update failed");
            }
        }, 'json')
    }

    function OnDeleteMember(usreIdx) {
        $.post('/deleteMember', { strMailIdx: mailIdx }, (res) => {
            console.log(res.status);
            if (res.status == 201) {
                loadMembers();
            } else {
                console.log("Delete failed");
            }
        }, 'json')
    }

    function OnOpenModal() {
        initModal();
        $('#modalCenter').toggleClass("show");
        if ($('#modalCenter').css('display') === 'none') {
            $('#modalCenter').css('display', 'block');
        } else {
            $('#modalCenter').css('display', 'none');
        }
    }

    function initModal() {
        $('#input_email_name').val('');
        $('#input_client_id').val('');
        $('#input_client_secret').val('');
    }
</script>